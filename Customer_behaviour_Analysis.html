<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Customer Behavior Analysis Dashboard</title>
    <script src="https://www.gstatic.com/charts/loader.js"></script>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
        }

        header {
            background: #f8f8f8;
            padding: 10px;
            text-align: center;
        }

        h1, h2 {
            color: #333;
        }

        #geo-chart, #area-chart, #stacked-bar-chart, #sentiment-pie-chart {
            margin: 20px 0;
        }

        footer {
            text-align: center;
            margin-top: 20px;
        }

        .bar {
            fill: steelblue;
        }

        .x-axis path,
        .x-axis line {
            display: none;
        }

        .legend rect {
            fill: steelblue;
        }
    </style>
</head>
<body>
    <header>
        <h1>Customer Behavior Analysis Dashboard</h1>
    </header>

    <main>
     

        <!-- Area Chart for Customer Churn Rate by Month -->
        <section id="churn-rate">
            <h2>Customer Churn Rate by Month</h2>
            <div id="area-chart"></div>
        </section>

        <!-- Stacked Bar Chart for Product Preferences by Customer Segment -->
        <section id="product-preferences">
            <h2>Product Preferences by Customer Segment</h2>
            <div id="stacked-bar-chart"></div>
        </section>

        <!-- Pie Chart for Customer Feedback Sentiment Analysis -->
        <section id="feedback-sentiment">
            <h2>Customer Feedback Sentiment Analysis</h2>
            <div id="sentiment-pie-chart"></div>
        </section>
    </main>

    
    <script>
        // Load Google Charts
        google.charts.load('current', { packages: ['corechart', 'geochart'] });

        // Geographical Distribution of Customers (Google GeoChart)
        google.charts.setOnLoadCallback(drawGeoChart);
        function drawGeoChart() {
            var data = google.visualization.arrayToDataTable([
                ['Country', 'Number of Customers'],
                ['United States', 1000],
                ['India', 750],
                ['Germany', 500],
                ['Australia', 300],
                ['Brazil', 200]
            ]);

            var options = {
                colorAxis: { colors: ['#e0f7fa', '#00695c'] }
            };

            var chart = new google.visualization.GeoChart(document.getElementById('geo-chart'));
            chart.draw(data, options);
        }

        // Customer Churn Rate by Month (Google Area Chart)
        google.charts.setOnLoadCallback(drawAreaChart);
        function drawAreaChart() {
            var data = google.visualization.arrayToDataTable([
                ['Month', 'Churn Rate'],
                ['Jan', 0.05],
                ['Feb', 0.04],
                ['Mar', 0.03],
                ['Apr', 0.06],
                ['May', 0.07],
                ['Jun', 0.08]
            ]);

            var options = {
                title: 'Customer Churn Rate by Month',
                hAxis: { title: 'Month' },
                vAxis: { title: 'Churn Rate' },
                colors: ['#ff7043'],
                isStacked: true
            };

            var chart = new google.visualization.AreaChart(document.getElementById('area-chart'));
            chart.draw(data, options);
        }

        // Product Preferences by Customer Segment (D3.js Stacked Bar Chart)
        const productData = [
            { segment: 'Youth', electronics: 200, fashion: 300, sports: 100 },
            { segment: 'Adults', electronics: 250, fashion: 400, sports: 150 },
            { segment: 'Seniors', electronics: 150, fashion: 200, sports: 50 }
        ];

        const margin = { top: 20, right: 30, bottom: 40, left: 50 },
              width = 600 - margin.left - margin.right,
              height = 400 - margin.top - margin.bottom;

        const svgStackedBar = d3.select("#stacked-bar-chart")
            .append("svg")
            .attr("width", width + margin.left + margin.right)
            .attr("height", height + margin.top + margin.bottom)
            .append("g")
            .attr("transform", `translate(${margin.left},${margin.top})`);

        const xStacked = d3.scaleBand()
            .domain(productData.map(d => d.segment))
            .range([0, width])
            .padding(0.2);

        const yStacked = d3.scaleLinear()
            .domain([0, 700])
            .range([height, 0]);

        const color = d3.scaleOrdinal()
            .domain(['electronics', 'fashion', 'sports'])
            .range(['#4db6ac', '#ff7043', '#8e24aa']);

        const stackedData = d3.stack()
            .keys(['electronics', 'fashion', 'sports'])
            (productData);

        svgStackedBar.append("g")
            .attr("transform", `translate(0,${height})`)
            .call(d3.axisBottom(xStacked));

        svgStackedBar.append("g")
            .call(d3.axisLeft(yStacked));

        svgStackedBar.selectAll("g.layer")
            .data(stackedData)
            .enter()
            .append("g")
            .attr("class", "layer")
            .attr("fill", d => color(d.key))
            .selectAll("rect")
            .data(d => d)
            .enter()
            .append("rect")
            .attr("x", d => xStacked(d.data.segment))
            .attr("y", d => yStacked(d[1]))
            .attr("height", d => yStacked(d[0]) - yStacked(d[1]))
            .attr("width", xStacked.bandwidth());

        // Customer Feedback Sentiment Analysis (D3.js Pie Chart)
        const sentimentData = [
            { sentiment: 'Positive', count: 600 },
            { sentiment: 'Neutral', count: 300 },
            { sentiment: 'Negative', count: 100 }
        ];

        const radius = Math.min(width, height) / 2;

        const svgPie = d3.select("#sentiment-pie-chart")
            .append("svg")
            .attr("width", width)
            .attr("height", height)
            .append("g")
            .attr("transform", `translate(${width / 2},${height / 2})`);

        const pie = d3.pie()
            .value(d => d.count);

        const arc = d3.arc()
            .innerRadius(0)
            .outerRadius(radius);

        const colorPie = d3.scaleOrdinal()
            .domain(sentimentData.map(d => d.sentiment))
            .range(['#66bb6a', '#ffb74d', '#e57373']);

        const arcs = svgPie.selectAll("arc")
            .data(pie(sentimentData))
            .enter()
            .append("g")
            .attr("class", "arc");

        arcs.append("path")
            .attr("d", arc)
            .attr("fill", d => colorPie(d.data.sentiment));

        arcs.append("text")
            .attr("transform", d => `translate(${arc.centroid(d)})`)
            .attr("text-anchor", "middle")
            .text(d => d.data.sentiment);
    </script>
</body>
</html>
